---
title: "Calibration Curve"
author: "Uriah Finkel"
date: "2024-05-15"
description: "An example of creating a calibration curve using rtichoke and scikit-learn."
categories: [calibration, scikit-learn]
draft: false
---

The following example is inspired by the scikit-learn documentation displaying a calibration curve.

## Load data and fit models

```{python}
from sklearn.datasets import make_classification
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LogisticRegression
from sklearn.naive_bayes import GaussianNB

X, y = make_classification(
    n_samples=10_000, n_features=20, n_informative=2, n_redundant=10, random_state=42
)

X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.99, random_state=42
)

lr = LogisticRegression(C=1.0)
gnb = GaussianNB()

lr.fit(X_train, y_train)
gnb.fit(X_train, y_train)

y_proba_lr = lr.predict_proba(X_test)[:, 1]
y_proba_gnb = gnb.predict_proba(X_test)[:, 1]

```

## Create calibration curve

```{python}
import plotly.io as pio
pio.renderers.default = "plotly_mimetype+notebook_connected"
from rtichoke import create_calibration_curve

create_calibration_curve(
    probs={"Logistic": y_proba_lr, "Naive Bayes": y_proba_gnb},
    reals=y_test
)
```
